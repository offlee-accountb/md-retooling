정상 텍스트로 복원된 전체 파일
한국산업표준 KS X 6101:2024
개방형 워드프로세서 마크업 언어(OWPML) 문서 구조
Open Word Processor Markup Language(OWPML) document structure
개정일: 2024년 10월 30일
제정일: 2011년 12월 30일
머리말
이 표준은 「산업표준화법」 관련 규정에 따라 산업표준심의회의 심의를 거쳐 개정한 한국산업표준이다. 이에 따라 KS X 6101:2018은 개정되어 이 표준으로 바뀌었다.
이 표준의 내용 일부 또는 전부는 저작권법에 따른 보호 대상이 되는 저작물이 될 수 있다.
이 표준의 내용 일부 또는 전부가 ISO·IEC 등에서 제정한 표준을 참고하여 제정 또는 개정된 경우, 해당 표준의 저작권을 보유하고 있는 ISO·IEC 등의 저작권 보호 규정 등에 따라 보호되어야 한다.
이 표준의 일부가 기술적 성질을 가진 특허권, 출원공개 이후의 특허출원, 실용신안권 또는 출원공개 후의 실용신안등록출원에 저촉될 가능성이 있다는 것에 주의를 환기한다. 관계 중앙행정기관의 장과 산업표준심의회는 이러한 기술적 성질을 가진 특허권, 출원공개 이후의 특허출원, 실용신안권 또는 출원공개 후의 실용신안등록출원에 관계되는 확인에 대하여 책임을 지지 않는다.
개요
이 표준은 2018년 1차 개정이 실시되었지만, 그 후의 개방형 텍스트 문서 관련 기술의 변화와 다양한 추가사항 및 기계 가독성을 높일 수 있는 구조를 포함하는 개방형 텍스트 문서 포맷 시장에 대응하고, 이전 버전에 포함된 스키마 오류를 바로잡고, OWPML 개방형 텍스트 문서 규격을 활용하고자 하는 많은 개발자들에게 보다 상세한 기술적 정보를 제공하여 활용도를 높이기 위하여 개정하였다.
이 표준은 공공 및 민간에서 국내 문서 형식으로 사용되고 있는 HWP 형식의 바이너리 문서 파일에 대한 개방성, 호환성, 보존성을 확보하기 위해 바이너리 포맷보다 개방성과 기술적 해석이 용이한 XML 기반의 패키지 포맷으로 제정되었다. 특히 공공 부문의 경우 업무를 위해 작성된 많은 문서, 공공 영역에서 배포되는 다양한 서식이 HWP 바이너리 또는 개방형 포맷인 HWPX 형식으로 작성되어 처리되고 있으며, XML 기반의 개방형 문서 형식이 아닌 바이너리(HWP 바이너리 문서 형식은 해당 개발사에서 개방성 확보를 위해 공개함) 문서 형식의 사용으로 인해서 기간 시스템 간의 연동 등 다양한 문제가 발생할 수 있다. 또한, 기존에 생성된 다양한 버전의 HWP 바이너리 문서가 기술적 변화로 인해서 문서 및 콘텐츠에 대한 열람, 편집을 보장할 수 없는 경우도 발생할 수 있다. 이에 개방적이며 기존 HWP 바이너리 형식의 문서에 대해 100% 호환성을 제공하고, 문서의 장기 보존에 대한 대비를 위한 기반을 마련하여, 한국의 문서 편집 문화를 잘 표현할 수 있도록 XML 기반의 개방형 문서 표준의 필요에 의해 제정되었다.
이 개방형 표준을 제정함으로써 어느 편집기에서나 HWP 문서 포맷을 지원하도록 처리하는 기술을 개발할 수 있다. 이 표준의 기반이 된 HWPML(Hangeul Word Processor Markup Language)은 1998년에 국내 소프트웨어 업체에서 개발되어 20여 년간 문서 작성, 유통 등 다양하게 사용되어 왔다. 그러나 문서 구성에 필요한 리소스가 분리되지 않고, 일부 의미가 모호하게 정의되어 있으며, DRM 등 기존 표준을 적용하기 어려운 문제가 있어, 이러한 문제점을 개선하고 발전시켜 제정한 형식이 이 표준이다.
특히, OWPML 문서 규격이 달성하고자 하는 목표는 다음과 같다.
워드프로세서 콘텐츠 생성자에게 콘텐츠 생성에 필요한 기술 요소를 제공함으로써 생성된 콘텐츠가 다양한 리딩 시스템(Reading system) 및 콘텐츠 생성 도구에서 생성자의 의도대로 올바르게 표현되고 재수정 될 수 있도록 한다.
기존의 HWP 문서와의 호환성을 반영한다.
콘텐츠 생성 및 표현 방식의 표준을 정의함으로써 HWP 문서의 유통 및 마이그레이션을 지원하고, 기술독립적 환경을 구축한다.
OWPML의 개방성을 높이고 정보 제공의 정확성을 높인다.
기술의 변화에 대비하여 텍스트 형식의 문서의 내용 및 맥락 정보를 장기간 보존할 수 있도록 한다.
이 표준에서 정의하는 형식은 문서 내용에 대한 구조적 정보를 표현하는 XML 기반의 문서 형식과 이에 필요한 공유 리소스들 간의 논리적인 구조 정보, 그리고 이러한 요소들을 하나의 물리적인 파일로 패키징할 수 있는 논리적인 컨테이너 및 물리적 패키징 개념을 도입하였다. 이러한 구성으로 인해서 소프트웨어 편집기에서 OWPML 문서 작성 및 표현 기술 개발 시 필요한 콘텐츠만을 선별적으로 메모리에 적재하여 사용할 수 있는 유연한 문서 파일 형식으로 개발되었다.
또한 W3C XML 암호화 방식과 전자서명 방식 등 기존 표준을 도입하여 보다 신뢰성 있고 개방적인 문서 형식으로 발전하였다.
이 표준은 문서처리기준 및 처리언어(JTC 1/SC 34) 전문위원회에서 표준의 내용 및 방향에 대한 검토 및 바이너리 형식과의 연계성을 검증하는 절차를 거쳐 개발되었다. 표준 제정을 통하여 문서의 마이그레이션, 변환 등에 있어 기술적인 장벽을 제거하고, 문서의 장기보존 시에 발생될 수 있는 기술의 변화 등에도 유연하게 대비할 수 있어 다양한 활용의 기회가 생겼다고 할 수 있다.
1. 적용범위
이 표준에서 규정하고 있는 개방형 워드프로세서 마크업 언어 OWPML(Open Word-Processor Markup Language)은 개방형 문서 형식으로 텍스트 유형의 콘텐츠 표현에 관한 표준이다. 또한 XML 기반의 개방된 형식으로 바이너리 형식의 HWP 문서를 정확하게 기술하기 위해 2018년 1차 개정되었으며, 문서 요소를 추가하고 각각 기존 문서 요소에 상세한 설명과 예제를 추가하여 수요자의 이해를 돕고 문서의 하위 호환성과 사용자의 확장성을 지원하고자 2차 개정되었다.
이 표준은
개방형 텍스트 문서를 표현하는 방식에 대하여
바이너리 HWP 문서 포맷을 100% 호환할 수 있는 문서 규격에 대하여
하위 호환성 증가 방안에 대하여
문서의 메타데이터 추가 및 확장성을 제공하는 방식에 대하여 규정한다.
이 표준은 OWPML(HWPX) 개방형 문서를 생성, 처리 등의 작업을 수행하는 IT 개발자를 위해 필요하며, 기타 OWPML 문서와 OOXML, ODF 등 개방형 문서와의 호환 기술을 개발하는 개발사가 이 표준의 수요자가 된다.
2. 인용표준
다음의 인용표준은 전체 또는 부분적으로 이 표준의 적용을 위해 필수적이다. 발행연도가 표기된 인용표준은 인용된 판만을 적용하며, 발행연도가 표기되지 않은 인용표준은 최신판(모든 추록을 포함)을 적용한다.
KS X ISO 8601: 데이터 요소 및 교환 포맷 — 정보교환 — 날짜 및 시각의 표기
ISO 3166-1: Codes for the representation of names of countries and their subdivisions — Part 1: Country codes
ISO/IEC 26300-1:2015: Open Document Format for Office Applications (OpenDocument) v1.2 - Part 1: OpenDocument Schema
ISO/IEC 26300-3:2015: Open Document Format for Office Applications (OpenDocument) v1.2 - Part 3: Packages
XML 1.1: W3C(The World Wide Web Consortium) Extensible Markup Language(XML) 1.1(Second Edition) 2006
CSS Values and Units Module Level 3: W3C Candidate Recommendation, 01 December 2022
Namespaces in XML 1.1: W3C(The World Wide Web Consortium), Namespaces in XML 1.1 (Second Edition) 2006
Unicode 4.0: The Unicode Consortium, The Unicode Standard, Version 4.0.0
XML-Signature Syntax and Processing Version 1.1: W3C Recommendation 11 April 2013
XML Encryption Syntax and Processing Version 1.1: W3C Recommendation 11 April 2013
MIME MEDIA TYPE: IANA(Internet Assigned Numbers Authority), MIME MEDIA TYPE
3. 용어와 정의
이 표준의 목적을 위하여 다음의 용어와 정의를 적용한다.
3.1 HWP(Hangeul Word-Processor) 문서: 1989년 이후 (주)한글과컴퓨터에서 개발한 한글 워드프로세서 프로그램으로 생성되는 바이너리 형식의 전자문서
3.2 IDPF(International Digital Publishing Forum): 국제 디지털 출판 포럼. 전자 출판 산업의 표준을 수립하기 위해 성립된 디지털 출판 산업을 위한 무역 및 표준 협회
3.3 OCF(Open Container Format): IDPF(3.2)에서 정의한 전자책을 위한 포맷 중의 하나인 컨테이너 포맷
3.4 EPUB Publication: ISO/IEC 23736 표준에서 정의하는 전자책의 논리적 구조 정보를 표현하는 표준
3.5 OPS(Open Publication Structure): IDPF(3.2)에서 정의한 전자책을 위한 공개 출판 구조 포맷
3.6 OPF(Open Packaging Format): IDPF(3.2)에서 정의한 전자책을 위한 공개 패키징 포맷
3.7 EPUB Content documents: 전자책의 콘텐츠 표현을 위한 표준
3.8 OWPML(Open Word-Processor Markup Language): 이 표준에서 정의하는 개방형 워드프로세서 문서 형식
3.9 대체(fall-back): 동일한 콘텐츠를 표현하는 다른 미디어 형식의 파일을 연결된 정보를 통해 찾아가는 방식으로, 해당 리딩 시스템(3.12)이 처리할 수 있는 파일을 찾는 행위
3.10 ZIP: 번들링(bundling)과 압축에 대한 파일 포맷
3.11 XML 네임스페이스: XML 요소의 이름과 속성의 고유한 URI 형식 식별자
3.12 리딩 시스템(reading system): OWPML(3.8) 문서를 읽고, 편집할 수 있는 애플리케이션 또는 시스템
3.13 SP 그룹(significant property group): 텍스트 문서 구성 요소 정의 항목에 대한 용어 정의 및 그룹화
3.14 각주(footnote): 본문 내용에 대한 보충 자료를 구체적으로 제시하거나, 인용한 자료의 출처 등을 밝히는 현재 쪽의 맨 끝부분에 놓이는 주석
3.15 강조점: 문자열을 강조하는 목적으로 현재 글자의 위, 아래 또는 글자 사이에 찍는 점
3.16 개요: 본문의 내용을 간결하게 추려낸 주된 글 내용
3.17 개체: 텍스트, 도형(3.32), 그림, 글상자(3.25), 수식(3.45), 표, 글맵시, 소리, 플래시 등의 독립된 기능을 하는 단위
3.18 격자: 한 쪽에 들어갈 수 있는 줄 수를 제한하기 위한 표준 줄 간격
3.19 계산식: 표(3.64)에서 덧셈, 뺄셈, 곱셈, 나눗셈의 간단한 사칙연산 및 avg와 같은 통계 함수와 sum(left) 등과 같은 left, right, below, above의 범위 지정자로 구성된 식
3.20 교정 부호: 맞춤법, 띄어쓰기, 글자 크기, 문장 부호, 줄 바꾸기 등을 바로잡기 위하여 문서에 표시된 부호
3.21 구역: HWP 문서에서 본문의 영역을 구분 짓는 단위
3.22 글꼴: 글씨를 써 놓은 모양. 글씨체의 종류를 나타내며, 대표적인 글꼴로는 바탕체, 궁서체, 돋움체 같은 것들이 있다.
3.23 글맵시: 글자를 구부리거나 글자에 외곽선, 면 채우기(3.59), 그림자, 회전 등의 효과를 주어 문자를 꾸미는 기능
3.24 글머리표: 여러 개의 항목을 나열할 때 문단(3.36)의 머리에 불릿(bullet) 모양을 붙여서 입력하는 기능
3.25 글상자: 문서에 위치와 크기 조절, 개체(3.17) 안의 채우기(3.42) 효과, 테두리의 모양과 색깔 바꾸기 등을 자유자재로 설정하여 글을 담는 상자
3.26 글자 격자: 한 줄에 들어갈 수 있는 글자의 수를 제한하기 위한 표준 글자 간격
3.27 글자 모양: 글자 색 바꾸기, 기울임, 진하게, 밑줄, 취소선(3.61), 그림자, 양각, 음각, 외곽선, 첨자 등의 다양한 글자의 속성
3.28 글자 스타일: 글자를 꾸미기 위해 글꼴(3.22), 글자 크기 등의 글자 모양(3.27)만을 미리 지정한 하나의 형식
3.29 글자 위치: 글자의 기준선을 기준으로 위나 아래 위치
3.30 다단: 신문이나 회보, 찾아보기 등을 만들 때 읽기 쉽도록 한 쪽을 여러 개로 나눌 때 쓰는 것
3.31 덧말: 본문의 아래나 또는 위에 넣는 보충 설명
3.32 도형: 직선, 직사각형, 타원, 호, 다각형, 곡선, 자유선, 개체(3.17) 연결선, 글상자(3.25) 등 문서에 삽입하고 편집할 수 있는 개체(3.17)
3.33 머리말(header): 문서의 한 쪽의 맨 위에 한두 줄의 내용이 쪽마다 고정적으로 반복되는 것
3.34 꼬리말(footer): 문서의 한 쪽의 맨 아래에 한두 줄의 내용이 쪽마다 고정적으로 반복되는 것
3.35 메모(memo): 현재 입력 중인 문서에서 특정 단어나 블록으로 설정한 문자열에 대해 편집자 기준으로 오른편에 글상자(3.25)가 실행되어 추가 내용을 입력하는 기능
3.36 문단: 여러 문장이 이어지다가 문맥에 따라 줄이 바뀌는 부분
3.37 미주(endnote): 본문 내용에 대한 보충 자료를 구체적으로 제시하거나 인용한 자료의 출처 등을 밝히는 현재 구역(3.21)의 맨 끝부분에 놓이는 주석
3.38 바탕글 스타일: 문서의 기본 문단(3.36) 스타일
3.39 바탕쪽: 문서 전체 쪽에 공통으로 적용되는 모양
3.40 상호 참조: 다른 쪽의 그림, 표(3.64) 등을 본문에서 항상 참조할 수 있도록 그 위치를 표시해 주는 기능
3.41 색인(index): 책이나 학술서, 연구 대상이 된 서적의 내용 중에서 중요한 항목, 술어, 인명, 지명 등을 뽑아 본문 어느 쪽에 위치하는지 바로 찾아볼 수 있도록 쪽 번호와 함께 별도로 배열하여 놓은 목록
3.42 선택 글자 보호: 현재 화면에서 편집하고 있는 문서 내용 중 사용자가 블록으로 지정한 영역에 암호를 걸어 사용자가 선택한 문자로 변경하여 개인 정보를 보호하는 기능
3.43 세로 정렬: 줄 안에서 각 글자의 위치를 세로로 정렬할 때 글자의 위쪽, 가운데, 아래쪽을 정하여 정렬하는 것
3.44 가로 정렬: 줄 안에서 각 글자의 위치를 가로로 정렬할 때 글자의 왼쪽, 가운데, 오른쪽을 정하여 정렬하는 것
3.45 수식: 수 또는 양을 나타내는 숫자나 문자를 연산 기호로 연결한 식과 수식(3.45)을 명령어를 이용하여 작성한 것
3.46 숨은 설명(hidden comment): 실제 문서의 내용에는 포함되지 않으면서, 파일을 편집하는 사람에게 필요한 메모(3.35)나 주의사항 등을 기록한 것
3.47 스크립트(script): 이벤트 속성 또는 양식 개체(3.50)의 이벤트 내용을 실행시키게 하는 것
3.48 스타일(style): 글꼴(3.22), 크기, 장평(3.54), 자간(3.53), 왼쪽 여백, 오른쪽 여백, 첫 줄, 정렬 방식, 줄 간격(3.57), 문단(3.36) 종류와 같은 문서의 전체적인 꾸밈 정보
3.49 시작 번호: 문서 내에서 사용되는 각종 개체들의 번호의 시작 숫자
3.50 양식 개체: 편집 화면에 넣을 수 있는 명령 단추, 선택 상자, 콤보 상자, 라디오 단추, 입력 상자의 개체(3.17)
3.51 용지 방향: 편집 용지를 좁게 쓸 것인가 넓게 쓸 것인가에 대한 방향 정의
3.52 용지 여백: 선택한 용지 설정에서 본문, 머리말(3.33), 꼬리말(3.34), 각주(3.14) 영역을 제외한 편집 용지상의 나머지 상하좌우 여백
3.53 자간: 글자와 글자 사이의 간격
3.54 장평: 글자의 가로/세로 비율. 글자의 세로 길이는 그대로 유지하면서 글자의 가로 폭을 줄이거나 늘리는 것
3.55 조판 부호: 편집 과정에서 사용자가 내리는 명령을 문서에 기록하여 나타내는 부호
3.56 주석(comment): 각주(3.14), 미주(3.37), 숨은 설명의 통칭
3.57 줄 간격: 지금 줄의 맨 위부터 다음 줄의 맨 위까지의 간격
3.58 차례: 책이나 글 따위에서 따로 적어 놓은 항목
3.59 채우기: 문서에서 표현되는 모든 개체의 면을 지정된 색과 지정된 패턴으로 채우는 기능
3.60 책갈피(bookmark): 문서를 편집하는 도중에 본문의 임의의 곳에 표시를 해 두었다가 현재 커서의 위치에 상관없이 표시해 둔 곳으로 커서를 곧바로 이동시키는 기능
3.61 취소선(strikeout): 선택한 단어나 블록 지정한 부분에 다양한 선과 모양으로 취소를 의미하는 선
3.62 캡션(caption): 본문에 들어가는 그림, 표(3.64), 그리기 개체(3.17), 수식(3.45)에 필요에 따라 번호와 제목, 간단한 설명을 붙이는 것
3.63 편집 용지: 어떤 크기의 용지에 편집할 것인지, 용지 방향(3.51), 용지 여백(3.52) 등에 대한 설정
3.64 표(table): 문서를 만들면서 복잡한 내용이나 수치 자료를 일목요연하게 정리하고자 할 때 이용하는 것
3.65 하이퍼링크(hyperlink): 문서의 특정한 위치에 현재 문서나 다른 문서, 웹 페이지, 전자 우편 주소 등을 연결하여 쉽게 참조하거나 이동할 수 있게 해 주는 것
3.66 전자서명: 문서에 디지털 서명을 하는 기능
3.67 변경 추적: 문서의 추가, 삭제, 서식 변경사항과 같은 수정내역을 기록하여 변경된 내용을 확인할 수 있는 기능
3.68 절대단위: 문서 내 다양한 수치를 나타내는 단위로, 물리적인 고정 값과 연관된 값을 나타내는 단위
3.69 상대단위: 문서 내 다양한 수치를 나타내는 단위로, 기준으로부터 상대적인 크기를 값으로 나타내는 단위
4. 적합성
4.1 일반사항
이 표준에 따라 생성된 OWPML(HWPX) 문서는 표준 적합성을 평가할 수 있다. 또한 OWPML 표준 문서 형식을 해석하여 편집 문서로 읽을 수 있는 리딩 시스템에 대해서도 성능이나 호환성 평가를 수행할 필요가 있다. 이 경우 아래 세부 사항에 따라 평가할 수 있다.
4.2 OWPML XML 콘텐츠 문서의 조건
이 표준에서 정의하는 콘텐츠 문서는 다음 조건을 만족해야 한다.
OWPML에 포함된 XML 문서는 이 표준에서 정의한 스키마를 만족하는 유효한(valid) XML 문서여야 한다.
모든 XML 문서의 기본 인코딩 형식은 UTF-8을 사용해야 한다.
모든 XML 문서의 MIMETYPE은 application/xml 미디어 유형을 지녀야 한다.
4.3 리딩 시스템의 적합성
이 표준은 리딩 시스템에 대해 한 단계의 적합성만을 정의한다. 리딩 시스템은 다음과 같이 문서를 처리할 때에만 적합성을 인정받을 수 있다.
OWPML 콘텐츠 문서를 처리할 때 리딩 시스템은 반드시 다음 조건을 충족해야 한다.
정형성(well-formedness)과 오류의 처리 등을 포함한 XML 1.1 규격의 원칙에 따라 XML을 처리해야 한다.
대체(fall-back) 부재 시, 지원되지 않는 미디어 유형의 <img> 또는 object 요소를 무시하고 문서를 표현하는 단계(렌더링)를 수행하지 않아야 한다.
‘XML 네임스페이스와의 관계’에서 정의된 것과 같이, 적합한 네임스페이스 규칙의 존재를 존중해야 한다.
4.4 OWPML 문서 호환성 및 적합성 조건
이 표준은 텍스트형 문서에 대한 개방형 포맷으로 다양한 텍스트형 문서와의 호환성 및 본 표준에 대한 적합성을 판단하는 데 보다 명확한 기준을 제시하기 위해 문서 내 지원되는 콘텐츠 요소를 SP(Significant Property)로 구분하여 호환성 및 적합성을 4단계로 나누어 정의한다.
레벨 0 (Level 0): SP0 그룹의 콘텐츠 요소가 지원 대상에 포함되어야 한다. (용어정의 3.13 - 3.18 항목)
레벨 1 (Level 1): SP1 그룹의 콘텐츠 요소가 지원 대상에 포함되어야 한다. (용어정의 3.19 - 3.24 항목)
레벨 2 (Level 2): 레벨 1 단계를 지원하고 SP2 그룹의 콘텐츠 요소가 지원 대상에 포함되어야 한다. (용어정의 3.25 - 3.43 항목)
레벨 3 (Level 3): 레벨 1, 2 단계를 지원하고 SP3 그룹의 콘텐츠 요소가 지원 대상에 포함되어야 한다. (용어정의 3.44 - 3.64 항목)
SP 그룹	SP0 항목	SP1 항목	SP2 항목	SP3 항목
문서 요소	3.13-3.18	3.19-3.24	3.25-3.43	3.44-3.64
5. 다른 기술 표준과의 관계
이 표준과 관련되거나 포함되는 기술 표준과의 관계를 설명한다.
5.1 XML과의 관계
이 표준은 XML을 기반으로 한다. 이는 XML의 일관성과 단순성 때문이며, XML 문서는 앞으로 등장할 새로운 기술에 잘 적응할 것으로 기대되기 때문이다. 또한 XML 기반 문서의 논리적 구조를 설정하는 문법 정의를 위한 정형화된 규칙을 제공하며, 이는 기술 구현자들의 업무 시간과 비용을 절감시키고 시스템 간 호환성을 높이는 이점이 있다. 또한, XML은 확장이 가능하다. 즉, XML은 특정 문서유형이나 특정 유형의 요소 집합에 독점적이지 않아 문서의 일부분을 보다 직접적으로 추가할 수 있는 문서 마크업을 활성화하여 자동 포맷팅 등의 컴퓨터 처리작업을 통해 수정할 수 있도록 한다.
XML 1.1에 정의된 대로 리딩 시스템은 반드시 XML 프로세서이어야 한다. 모든 OWPML 콘텐츠 문서들은 반드시 해당 스키마에 따라 유효한 XML 문서이어야 한다.
5.2 XML 네임스페이스와의 관계
리딩 시스템은 반드시 http://www.w3.org/TR/xml-names11/의 XML 네임스페이스 권고사항에 따라 XML 네임스페이스를 처리해야 한다.
네임스페이스 접두어는 각기 다른 XML 어휘에서 따온 동일한 명칭을 구분해야 한다. XML 문서의 XML 네임스페이스 선언은 고유한 네임스페이스 접두어를 고유한 URI에 연계시킨다. 이 접두어는 문서의 요소 이름이나 속성 이름에 사용될 수 있다. 반면, XML 문서 내의 네임스페이스 선언은 URI를 기본 네임스페이스로 식별하여 네임스페이스 접두어를 가지지 못한 요소들에 적용된다. OWPML 문서는 아래와 같은 형식으로 네임스페이스를 선언하여 활용하며, 본 표준의 개정 수준에 따라 네임스페이스는 변경하여 문서의 버전을 확인하는 데 활용될 수 있다.
보기:
code
Xml
xmlns:hh="http://www.owpml.org/owpml/2024/head"
xmlns:hb="http://www.owpml.org/owpml/2024/body"
xmlns:hp="http://www.owpml.org/owpml/2024/paragraph"
xmlns:hc="http://www.owpml.org/owpml/2024/core"
xmlns:hv="http://www.owpml.org/owpml/2024/version"
xmlns:hm="http://www.owpml.org/owpml/2024/master-page"
xmlns:hs="http://www.owpml.org/owpml/2024/history"
모든 OWPML 문서의 최상위 요소는 반드시 문서의 네임스페이스를 명확하게 명시해야 한다. OWPML 네임스페이스가 문서에서 사용되는 경우, 반드시 http://www.owpml.org/owpml/2024/head 또는 http://www.owpml.org/owpml/2024/body 등으로 명확히 선언되어야 한다. 네임스페이스 접두어가 사용된 경우, 저자들에게 hh 또는 hb 접두어를 사용하여 이 네임스페이스로 바인딩하고, hh, hb를 다른 네임스페이스의 접두어로 사용하지 않을 것을 권고한다.
보기:
code
Xml
<head xmlns="http://www.owpml.org/owpml/2024/head">
5.3 유니코드와의 관계
HWP 문서들은 유니코드에 정의된 것과 같이 UTF-8 인코딩을 사용하여 전체 유니코드 문자 집합을 사용할 수 있다. 유니코드의 사용으로 국제화, 그리고 여러 가지 언어로 문서를 작성하는 일이 쉬워진다. 하지만, 리딩 시스템은 모든 유니코드 문자에 대해 글자(glyph)를 제공하지 않을 수 있다.
리딩 시스템은 반드시 UTF-8 문자를 제대로 파싱(parse)해야 한다. 리딩 시스템은 일부 문자의 표시를 거부할 수 있지만, 표시할 수 없는 문자가 있다는 사실을 반드시 표시해야 한다. 리딩 시스템은 유니코드 문자를 구성하는 바이트(byte)를 개별 문자로 표시해서는 안 된다.
리딩 시스템의 지속적 검색 및 분류작업을 지원하기 위해서, 유니코드 정규화 양식 C(Unicode Normalization Form C, NFC)를 반드시 사용해야 한다. (http://www.w3.org/TR/charmod-norm/ 참조)
5.4 MIME 미디어 유형
이 표준은 모든 리딩 시스템이 반드시 지원하고 HWP 문서 파일이 포함할 수 있는 OWPML 핵심 미디어 유형의 목록을 정의한다. 핵심 미디어 유형 이외의 형식을 추가하는 경우에는 IANA(Internet Assigned Numbers Authority)의 공식 미디어 형식 목록에 따라 표기해야 한다.
OWPML 핵심 미디어 유형은 다음과 같다.
표 1 — MIME 미디어 유형
| MIME 미디어 유형 | 참조 | 기술 |
| :--- | :--- | :--- |
| image/gif | http://www.w3.org/Graphics/GIF/spec-gif89a.txt | 래스터(Raster) 이미지에 사용 |
| image/jpeg | http://www.w3.org/Graphics/JPEG/ | 래스터(Raster) 이미지에 사용 |
| image/png | RFC 2083 | 래스터(Raster) 이미지에 사용 |
| application/xml | http://www.w3.org/TR/xml11/ | 외부 XML 콘텐츠에 사용 |
| application/javascript | http://www.ecma-international.org/publications/standards/Ecma-262.htm | 양식 객체의 스크립트에 사용 |
6. OWPML 스키마 구성
이 표준에서 기술하고 있는 OWPML 문서의 논리적 구조를 정의하는 XML 스키마는 5가지로 구성된다.
첫째는 문서 내에서 사용되는 모든 설정을 가지고 있는 header 스키마이다. header에는 구역에 대한 정의, 금칙 문자, 글꼴, 테두리/배경, 각종 객체에 대한 연결 정보 등이 들어있다.
둘째는 실제 문서 내용이 들어가는 Body 스키마이다. Body에는 사용자가 설정한 문서의 레이아웃대로 문서의 내용만이 저장된다.
셋째는 문서에 공통으로 적용되는 바탕쪽 설정이 들어있는 스키마이다.
넷째는 문서 이력 스키마이다. 문서 이력 정보는 추가/수정되었던 기록을 담고 있다.
다섯째는 패키지 포맷에 대한 정의 스키마로, 콘텐츠의 메타데이터를 담고 있다.
각 XML 스키마에 대한 구체적인 내용 설명은 다음 장부터 설명한다. 각 스키마에 대한 상세한 스키마 정의는 첨부된 [부속서] XML 스키마 문서 5종을 참조한다.
7. 기본 형식 및 단위
7.1 기본 형식
OWPML 문서는 리딩 시스템에 따라 다양한 단위로 글자 크기, 문단 간격 등 콘텐츠의 서식을 표현한다. 그러나 OWPML의 내부 논리적 구조 정보를 정의할 때는 한 가지 기본적으로 정해지는 단위가 필요하다. 이 장에서는 XML 스키마를 통해 정의되는 OWPML 문서에서 기본적으로 사용되는 단위(Unit)에 대해서 설명한다. 단위는 기본적으로 절대단위와 상대단위로 나뉘며, 절대 단위는 전자문서의 출력장치(모니터)의 물리적 속성을 아는 경우 효율적이며, 상대 단위는 이기종 간, 플랫폼 간의 호환성을 유지하는 데 편리하게 사용되는 단위이다.
7.2 단위
7.2.1 상대단위
기준이 되는 길이로부터 상대적인 값을 측정하는 길이를 상대 길이라고 하며, 이를 표현하는 단위를 상대단위라고 한다. OWPML 문서를 표현하는 데 절대단위 또는 상대단위를 사용해야 한다. 자세한 사항은 W3C CSS Values and Units Module Level 3 표준을 참고하기 바란다.
7.2.2 절대단위
절대 길이 단위는 물리적인 측정 장치와 연결되어 있으며 상호 고정되어 있는 단위를 말한다. 이 단위는 cm, mm, pt 등 물리적인 단위로 구성된다. 자세한 사항은 W3C CSS Values and Units Module Level 3 표준을 참고하기 바란다.
7.2.3 HWPUNIT
이 표준에서 정의하는 OWPML 텍스트 형식의 문서는 OOXML, ODF 등 텍스트형 문서를 표현하는 개방형 문서 표준들과의 호환성을 높이기 위해 상호 변환 오차를 최소화할 수 있도록 정의된 HWPUNIT이라는 단위를 사용해야 한다. HWPUNIT은 본 표준 및 바이너리 HWP 문서 형식에서 사용되는 공통 단위이며, 모든 단위가 표시되지 않는 속성 값들은 암묵적으로 단위를 HWPUNIT으로 해석해야 한다. 이 단위 크기에 대한 정의는 다음과 같다.
10 pt = 1000 HWPUNIT
7.2.4 HWPUNIT과 다른 단위와의 관계
HWPUNIT은 CSS의 절대 단위와 아래와 같은 값의 관계를 갖는다.
1 pt = 100 hwpunit
1 mm = 283.456 hwpunit
1 cm = 2834.56 hwpunit
1 inch = 7200 hwpunit
1 pixel = 75 hwpunit
1 char = 500 hwpunit
1 twips = 5 hwpunit
7.2.5 기타 단위 표현
이 표준에서 HWPUNIT 단위를 사용하는 경우 대부분 암시적으로 단위를 사용한다. 하지만 명시적으로 단위를 기술해야 하는 경우도 있다. 아래는 명시적으로 단위를 기술할 때 사용되는 XML 요소 형식(Complex Type)이다.
표 2 — HWPValue 형식
| 속성 이름 | 설명 |
| :--- | :--- |
| value | 실제 값 |
| unit | 값의 단위 |
속성 unit에 올 수 있는 값은 HWPUNIT, CHAR 등이며, 기본값은 CHAR이다.
예시 1: HWPValue 형식
code
Xml
<hh:margin>
    <hh:intent value="0" unit="HWPUNIT"/>
    <hh:left value="0" unit="HWPUNIT"/>
    <hh:right value="0" unit="HWPUNIT"/>
    <hh:prev value="0" unit="HWPUNIT"/>
    <hh:next value="1600" unit="HWPUNIT"/>
</hh:margin>
<hh:lineSpacing type="PERCENT" value="160" unit="HWPUNIT"/>
7.3 OWPML의 기본 자료 형식
OWPML에서 사용되는 기본 값들의 형태는 다음 표에 명시되어 있다.
(표 3 ~ 8: 각종 번호, 선 형식 등은 내용이 방대하여 생략되었으나, 원본 문서에 포함되어 있음)
7.4 OWPML의 색상 표현
OWPML 문서 내의 색상 표현은 16진수(Hex) 형식으로 표현될 수 있다. 이 값은 기본적으로 문자열이며, # 기호를 앞에 붙여 나타낸다.
표 9 — 색상 형식
| 속성 | 설명 |
| :--- | :--- |
| Base Type | xs:string |
| Extend Type| HEX value |
| Pattern | #[0-9A-Fa-f]{6} |
| Example | #01F39B |
8. 컨테이너 및 패키징
8.1 OCF
OWPML 문서는 콘텐츠를 구성하는 여러 파일들을 물리적으로 하나의 파일로 묶기 위해 개방형 컨테이너 포맷인 OCF(Open Container Format) 규격을 기반으로 생성되어야 한다.
8.2 OCF OWPML 프로파일
OWPML은 OCF에서 사용되는 기본 파일 및 디렉터리 외에 추가적인 파일 및 디렉터리를 사용한다. 그 중 version.xml은 필수적으로 사용되어야 하는 파일로써 OWPML 파일 형식에 대한 버전 정보를 가지고 있는 파일이다. 그 외의 디렉터리들은 선택적으로 사용된다.
ZIP Container
mimetype
version.xml
META-INF/
container.xml
manifest.xml (선택)
metadata.xml (선택)
signatures.xml (선택)
encryption.xml (선택)
rights.xml (선택)
Preview/
PrvText.txt
PrvImage.png
Chart/
chart1.xml
Contents/
content.hpf
header.xml
section0.xml
BinData/
img0.jpg
Scripts/
default.js
XMLTemplate/
TemplateSchema.xsd
DocHistory/
VersionLog0.xml
Custom/
Bibliography.xml
8.3 파일 형식 버전 식별
OWPML을 준수하는 OCF 컨테이너는 최상위 디렉터리의 직접 자식으로서 version.xml을 가지고 있어야 하며, 이 파일 안에는 파일 형식에 대한 버전을 기록하고 있어야 한다.
major: 문서 형식의 구조가 완전히 바뀌는 것을 나타낸다.
minor: 큰 구조는 동일하나, 큰 변화가 있는 것을 나타낸다.
micro: 구조는 동일하나, 하위 요소가 추가된 것을 나타낸다.
buildNumber: 하위 요소에 정보가 추가된 것을 나타낸다.
예시: version.xml